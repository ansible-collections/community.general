DOCUMENTATION:
  name: lists_mergeby
  short_description: Merge two lists of dictionaries by a given attribute
  version_added: 2.0.0
  author: Vladimir Botka (@vbotka)
  description:
    - Merge two lists by attribute I(index).
  positional: another_list, index
  options:
    _input:
      description: A list of dictionaries.
      type: list
      elements: dictionary
      required: true
    another_list:
      description: Another list of dictionaries.
      type: list
      elements: dictionary
      required: true
    index:
      description:
        - The dictionary key that must be present in every dictionary in every list that is used to
          merge the lists.
      type: string
      required: true

EXAMPLES: |
  - name: Merge two lists
    ansible.builtin.debug:
      msg: >-
        {{ list1 | community.general.lists_mergeby(list2, 'index') }}"
    vars:
      list1:
        - index: a
          value: 123
        - index: b
          value: 42
      list2:
        - index: a
          foo: bar
        - index: c
          foo: baz
    # Produces the following list of dictionaries:
    #   {
    #     "index": "a",
    #     "foo": "bar",
    #     "value": 123
    #   },
    #   {
    #     "index": "b",
    #     "value": 42
    #   },
    #   {
    #     "index": "c",
    #     "foo": "baz"
    #   }

RETURN:
  _value:
    description: The merged list.
    type: list
    elements: dictionary
