# Copyright (c) 2022, Ansible Project
# Copyright (c) 2022, VMware, Inc. All Rights Reserved.
# GNU General Public License v3.0+ (see LICENSES/GPL-3.0-or-later.txt or https://www.gnu.org/licenses/gpl-3.0.txt)
# SPDX-License-Identifier: GPL-3.0-or-later

- name: iso_customize
  hosts: localhost
  gather_facts: no
  vars:
    test_files_dir: "/Users/zouy/Documents"
  tasks:
    - name: "Customize ISO file"
      community.general.iso_customize:
        src_iso: "{{ test_files_dir }}/test.iso"
        dest_iso: "{{ test_files_dir }}//test_customized.iso"
        delete_files:
          - "/1.txt"
          - "/delete/1.txt"
        add_files:
          - src_file: "{{ test_files_dir }}/ubuntu.seed"
            dest_file: "/preseed/ubuntu.seed"
          - src_file: "{{ test_files_dir }}/grub.cfg"
            dest_file: "/boot/grub/grub.cfg"
      register: customize_iso_result

    - name: "Display the ISO customized result"
      debug: var=customize_iso_result
    
    - name: Test customize iso result
      assert:
        that:
        - customize_iso_result is not failed
