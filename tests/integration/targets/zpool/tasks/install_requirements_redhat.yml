---
# Copyright (c) 2025, Tom Hesse <contact@tomhesse.xyz>
# GNU General Public License v3.0+ (see LICENSES/GPL-3.0-or-later.txt or https://www.gnu.org/licenses/gpl-3.0.txt)
# SPDX-License-Identifier: GPL-3.0-or-later

- name: Query the rpm dist tag
  command: rpm --eval '%{dist}'
  register: zfs_dist_tag
  changed_when: false

- name: Install zfs repostiory
  ansible.builtin.package:
    name: "https://zfsonlinux.org/epel/zfs-release-2-3{{ zfs_dist_tag.stdout }}.noarch.rpm"
    state: present

- name: Install required packages
  ansible.builtin.package:
    name:
      - epel-release
      - kernel-devel
      - zfs
