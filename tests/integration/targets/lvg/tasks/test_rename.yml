---
# Copyright (c) Ansible Project
# GNU General Public License v3.0+ (see LICENSES/GPL-3.0-or-later.txt or https://www.gnu.org/licenses/gpl-3.0.txt)
# SPDX-License-Identifier: GPL-3.0-or-later

- name: Create volume group on disk device
  lvg:
    vg: testvg
    pvs: "{{ loop_device1 }}"

- name: Rename the volume group
  lvg:
    vg: testvg2
    old_vg: testvg
  register: vg_rename

- name: "get lvm facts"
  setup:

- name: Do all assertions to verify expected results
  assert:
    that:
      - vg_rename is changed
      - ansible_lvm.pvs[loop_device1].vg == 'testvg2'

- name: Revert the volume group rename
  lvg:
    vg: testvg
    old_vg: testvg2
